{% load myfilters %}
<div class="flex flex-col subsection"
     x-data="{open: false}"
     hx-target="find .subsection"
     hx-swap="afterbegin">
    <div class="flex flex-row" :class="sectionSelected && currentSectionId === {{sec.id}} && selectedclasses">
        <button @click="open = !open; currentSectionId = {{sec.id}}; sectionSelected = true" 
         class="flex basis-3/4">
            <i class="fa-solid" :class="open ? 'fa-caret-down' : 'fa-caret-right'"></i>
            <span class="pl-4">
                {{sec.name}}
            </span>
        </button>
        <div class="flex flex-row basis-1/4" :class="!sectionSelected || currentSectionId !== {{sec.id}} ? 'hidden' : ''">
            {% if user.can_write_main_section %}

            {% url 'core:modal_archive' sec.id as modal_arch_url %}
            {% btn_get modal_arch_url as sec_attrs %}
            {% include "core/button/simple_button.html" with add_attrs=sec_attrs button_class='fa-file' %}

            {% url 'core:modal_section' sec.id as modal_sec_url%}
            {% btn_get modal_sec_url as arch_attrs %}
            {% include "core/button/simple_button.html" with add_attrs=arch_attrs button_class="fa-plus"%}

            {% btn_delete modal_sec_url as del_sec_attrs %}
            {% include "core/button/simple_button.html" with add_attrs=del_sec_attrs button_class="fa-minus"%}

            {% endif %}
        </div>
    </div>
    {% if not single_sec %}
    {% include "core/section_view.html" with root_id=sec.id  secmap=secmap archmap=archmap %}
    {% endif %}
</div>
