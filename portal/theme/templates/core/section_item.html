<div hx-trigger="click once" 
     class="flex flex-col subsection"
     x-data="{ open: false }"
     hx-get="{% url 'core:children' sec.id %}" 
     hx-target="find .subsection" hx-swap="outerHTML">

  <div class="flex flex-col"
       hx-target="find .subsection"
       hx-swap="afterbegin">
    <div class="flex flex-row" :class="sectionSelected && currentSectionId === {{sec.id}} && selectedclasses">
      <button @click="open = !open; currentSectionId = {{sec.id}}; sectionSelected = true" 
              class="flex basis-3/4">
        <i class="fa-solid" :class="open ? 'fa-caret-down' : 'fa-caret-right'"></i>
        <span class="pl-4">
            {{sec.name}}
        </span>
      </button>
      <div class="flex flex-row basis-1/4" :class="!sectionSelected || currentSectionId !== {{sec.id}} ? 'hidden' : ''">
        {% if user.can_write_main_section %}
        <button hx-get="{% url 'core:modal_archive' sec.id %}"
                hx-target="#pivot-section"
                class="basis-1/3 pl-3 pr-3 border border-black rounded-full">
		<i class="fa-solid fa-file"></i>
	</button>
        <button hx-get="{% url 'core:modal_section' sec.id %}"
                hx-target="#pivot-section"
                class="basis-1/3 pl-3 pr-3 border border-black rounded-full">
		<i class="fa-solid fa-plus"></i>
	</button>
        <button hx-trigger="click consume" 
                hx-confirm="You sure want to delete the section?" 
                hx-delete="{% url 'core:section' sec.id %}"
                hx-target="closest .subsection"
                hx-swap="delete"
                class="basis-1/3 pl-3 pr-3 border border-black rounded-full">
        	<i class="fa-solid fa-xmark"></i>
        </button>
        {% endif %}
      </div>
    </div>
    <div class="subsection"></div>
  </div>
</div>
